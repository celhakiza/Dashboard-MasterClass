{%load static%} 
<!-- The above code tells the django that we will be loading static files and we need to provide path in the source -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Day 2</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
<div class="container">
    <h1 class="text-center my-4">Mini Dashboard</h1>
    <div class="row">
        <div class="col-3 my-4">
            <div class="card bg-info">
            <div class="card-body">
                <h5 class="card-title text-white">Users</h5>
                    <p class="card-text text-white">{{users}}</p>
                    <p class="card-text text-white"><small>Date: June 12 2025</small></p>
                </div>
            </div>
        </div>
        <div class="col-3 my-4">
            <div class="card bg-success">
            <div class="card-body">
                <h5 class="card-title text-white">Revenue</h5>
                    <p class="card-text text-white">${{revenue}}</p>
                    <p class="card-text text-white"><small>Date: June 12 2025</small></p>
                </div>
            </div>
        </div>
        <div class="col-3 my-4">
            <div class="card bg-secondary">
            <div class="card-body">
                <h5 class="card-title text-white">Errors</h5>
                    <p class="card-text text-white">{{errors}}</p>
                    <p class="card-text text-white"><small>Date: June 12 2025</small></p>
                </div>
            </div>
        </div>
        <div class="col-3 my-4">
            <div class="card bg-warning">
            <div class="card-body">
                <h5 class="card-title text-white">Sessions</h5>
                    <p class="card-text text-white">{{session}}</p>
                    <p class="card-text text-white"><small>Date: June 12 2025</small></p>
                </div>
            </div>
        </div>
    </div>
     
    <div class="row">
        <div class="col-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title text-left">User Growth Chart</h5>
                    <!-- here below we load the static image from the respective page -->
                    <canvas id="userChart"></canvas>
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title text-left">Revenue Trend</h5>
                    <canvas id="Chartrevenue"></canvas>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
    <h3 class="m-3">Recent Transactions</h3>
    <table class="table table-striped">
        <thead class="bg-black text-white">
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Amount</th>
                <th>Status</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for transaction in transactions %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ transaction.name }}</td>
                <td>${{ transaction.amount }}</td>
                <td>
                    {% if transaction.status == 'Paid' %}
                        <span class="bg-success px-2 py-1 rounded text-white">{{ transaction.status }}</span>
                    {% elif transaction.status == 'Pending' %}
                        <span class="bg-warning px-2 py-1 rounded">{{ transaction.status }}</span>
                    {% elif transaction.status == 'Failed' %}
                        <span class="bg-danger px-2 py-1 rounded text-white">{{ transaction.status }}</span>
                    {% else %}
                        {{ transaction.status }}
                    {% endif %}
                </td>
                <td>{{ transaction.created_at|date:"F d, Y" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">No transactions found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

    <!-- <div class="row">
        <h3 class="m-3">Recent Transactions</h3>
        <table class="table table-striped">
            <thead class="bg-black text-white">
                <tr>
                    <th>#</th>
                    <th>Name</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>John Doe</td>
                    <td>$250</td>
                    span inline element that apply only on specific portion of text
                    <td><span class="bg-success px-2 py-1 rounded text-white">Paid</span></td>
                    <td>June 12,2025</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Jane Smith</td>
                    <td>$180</td>
                    <td><span class="bg-warning px-2 py-1 rounded">Pending</span></td>
                    <td>June 11, 2025</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Michael Lee</td>
                    <td>$300</td>
                    <td><span class="bg-danger text-white px-2 py-1 rounded">Failed</span></td>
                    <td>June 12, 2025</td>
                </tr>

            </tbody>

        </table>
    </div> -->
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
        document.addEventListener('DOMContentLoaded', function(){
        fetch('/chart_data/').then(response => response.json()).then(
        data=>{
        new Chart(document.getElementById("userChart"), {
        type: "line",
        data: {
        labels: data.labels,
        datasets: [{
        label: "Users",
        backgroundColor: "rgba(75, 192, 192, 0.2)",
        borderColor: "rgba(75, 192, 192, 1)",
        data: data.user_data,
        fill: true
        }]
        },
        options: {}
        });
        });
        setInterval(()=>location.reload(), 5000);
        })
</script>
</body>
</html>